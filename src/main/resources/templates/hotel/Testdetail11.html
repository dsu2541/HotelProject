<!DOCTYPE html>
<html layout:decorate="~{/layout/layout}">

<meta charset="UTF-8">

<div layout:fragment="content" class="content-padding">

    
    <link rel="stylesheet" href="assets/css/jquery.datepick.css" type="text/css">
    <link rel="stylesheet" href="css/slide.css" type="text/css">
	        <style>
            #my_modal { 
            	font-family: 'Gowun Batang', sans-serif;
                display: none;
                width: 700px;
                height : 500px;
                padding: 20px 60px;
                background-color: #fefefe;
                border: 1px solid #888;
                border-radius: 3px;
            }

            #my_modal .modal_close_btn {
                position: absolute;
			    top: 10px;
			    right: 10px;
			    color: 488f3e; /* X 버튼 색상 변경 */
			    cursor: pointer; /* 마우스 커서 모양 변경 */
            }
           
	        li {
	        list-style:none;
	            margin: 30px 10px;
	        }
            
        </style>
        
        <!-- =======================================컨텐츠 시작================================================= -->


<div class="page-wrapper">
    <div id="page-content">
        <div class="container">
            <ol class="breadcrumb">
                <li><a href="#">Home</a></li>
                <li><a href="#">Listing</a></li>
                <li class="active">Detail</li>
            </ol>
            <!--end breadcrumb-->
            <div class="row">
                <div class="col-md-3">
                    <div class="sidebar">
                        <div class="box filter">
                            <h2>호텔 검색하기</h2>
                            <form id="searchForm" action="/hotel/hotellist1" method="get">
                                <div class="form-group">
                                   <input type="text" class="form-control input-lg" id="searchValue" style="width: 100%;" placeholder="검색하세요">
                                </div>
                               <button type="submit" class="btn btn-primary btn-rounded form-control">검색</button>
                            </form>
                             <!--end form-filter-->
                        </div>
                        <!--end filter-->
                        <!--end box-->
                        <a href="#" class="advertising-banner">
                            <span class="banner-badge">Advertising</span>
                            <img src="assets/img/ad_banner.png" alt="">
                        </a>
                    </div>
                    <!--end sidebar-->
                </div>
                <!--end col-md-3-->
                <div class="col-md-9 col-sm-8">
                    <div class="quick-navigation" data-fixed-after-touch="">
                        <div class="wrapper">
                            <ul>
                                <li><a href="#description" class="scroll">Description</a></li>
                                <li><a href="#map" class="scroll">Map</a></li>
                                <li><a href="#facilities" class="scroll">Facilities</a></li>
                                <li><a href="#additional-information" class="scroll">Additional Information</a></li>
                                <li><a href="#reviews" class="scroll">Reviews</a>(23)</li>
                            </ul>
                        </div>
                    </div>
                    <div class="main-content">
                        <div class="title">
                            <div class="left">
                                <h1><b>[[${dto1[0].hotel_name}]]</b><span class="rating"><i class="fa fa-star"></i>9.9</span></h1>
                                <h3><a href="#">[[${dto1[0].addr1}]]</a></h3>
                            </div>
                            <div class="right">
                                <a href="#map" class="icon scroll"><i class="fa fa-map-marker"></i>위치</a>
                                <a href="#availability" class="btn btn-primary btn-rounded scroll">객실 보기</a>
                            </div>
                        </div>
                        <!--end title-->
                         <!--호텔 사진 부분-->
                        <section id="gallery">
						      <div th:each="dto: ${searchHotelDetail}">
								    <img th:if="${dto.type == 'title'}" th:src="@{|/hotel/${dto.url}|}" style="max-width:100%; height:auto;"/>
							 </div>
						</section>
                        <h2>객실 설명</h2>
                        <div class="row">
                            <div class="col-md-8">
                                <section id="description">
                                   
                                    <p>
                                   [[${dto2[0].hotel_information}]]
                                    </p>
                                </section>
									<section id="facilities">
									    <h2>객실 소개</h2>
									    <ul class="bullets half">
									        <li th:if="${dto4[0].toiletries eq 1}">화장실</li>
									        <li th:if="${dto4[0].shower eq 1}">샤워시설</li>
									        <li th:if="${dto4[0].towel eq 1}">욕실시설</li>
									        <li th:if="${dto4[0].tv eq 1}">티브이</li>
									        <li th:if="${dto4[0].coffeemaker eq 1}">커피포트</li>
									        <li th:if="${dto4[0].air_conditional eq 1}">냉방시설</li>
									        <li th:if="${dto4[0].slipper eq 1}">객실 슬리퍼</li>
									        <li th:if="${dto4[0].heating eq 1}">난방시설</li>
									        <li th:if="${dto4[0].table1 eq 1}">테이블</li>
									        <li th:if="${dto4[0].pc eq 1}">pc시설</li>
									    </ul>
									</section>

                            </div>
                            <!--end col-md-8-->
                            <div class="col-md-4">
                                <div class="sidebar">
                                    <aside class="box">
                                        <dl>
                                            <dt>1-Bed Rooms:</dt>
                                            <dd>23</dd>
                                            <dt>2-Bed Rooms:</dt>
                                            <dd>48</dd>
                                            <dt>Apartments:</dt>
                                            <dd>12</dd>
                                            <dt>Parking:</dt>
                                            <dd>Free</dd>
                                            <dt>Swimming:</dt>
                                            <dd>Yes</dd>
                                            <dt>Ski Center:</dt>
                                            <dd>2km</dd>
                                        </dl>
                                    </aside>
                                </div>
                                <!--end sidebar-->
                            </div>
                            <!--end col-md-4-->
                        </div>
                        <!--end row-->

                        <section id="availability">
                            <h2>예약</h2>
                            <form class="labels-uppercase" id="form-availability">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="form-availability-check-in">Check In</label>
                                            <input type="text" class="form-control date" id="form-availability-check-in" name="checkin" placeholder="Check In">
                                        </div>
                                    </div>
                                    <!--end col-md-3-->
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="form-availability-check-out">Check out</label>
                                            <input type="text" class="form-control date" id="form-availability-check-out" name="checkout" placeholder="Check Out">
                                        </div>
                                    </div>
                                    <!--end col-md-3-->
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="invisible">Hidden label</label>
                                            <input type="hidden" name="hotel_id" th:value="${hotel_id}"> <!-- hotel_id hidden 필드 추가 -->
                                            <button type="submit" class="btn btn-primary btn-rounded btn-framed form-control">Search</button>
                                        </div>
                                    </div>
                                    <!--end col-md-3-->
                                </div>
                                <!--end row-->
                            </form>
                            <!-- end of form class = "labels-uppercase" -->

                            <div class="form-reservations">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>객실타입</th>
                                            <th>인원</th>
                                            <th>가격</th>
                                            <th>   예약하기   </th>
                                          
                                        </tr>
                                        </thead>
                                    </table>
                                </div>
                                <!-- 1.스탠다드룸에 대한 form id = "room_1" 태그 start -->
                                <form id="room_1" th:action="@{/paymentPage}" method="post">
                                <!-- 0424 input 태그 추가 4줄 부분 -->
                                  <input type="hidden" name="hotel_id" th:value="${dto2[0].hotel_id}"/>
								  <input type="hidden" name="room_type" value="standard"/>
								  <input type="hidden" name="checkin" th:value="${checkin}"/>
								  <input type="hidden" name="checkout" th:value="${checkout}"/>
                                    <table class="table">
                                        <tbody>
                                            <tr class="room">
                                                <td class="room-type">
                                                  <h3 style="color: #488f3e; cursor: pointer;" id="popup_open_btn">스탠다드</h3>                                       
                                                <ul class="info">
                                                   <li>객실 이름을 클릭하세요</li>
                                                   
                                                </ul>
                        <!--  ============================== 모달 부분 구분선================================== -->
											    <div id="my_modal">
											            <a class="modal_close_btn"><b>X</b></a>
											            <h3 class="modal-title" id="myModalLabel"><strong>객실 상세 보기</strong></h3>
											            <!-- 자동 캐러셀 시작 -->
											            <br/><br/>
											          <div class="Content"> <!--전체를 감쌀 뼈대-->
															<div class="slides">  <!--슬라이드 아이템을 감쌀 뼈대-->
															  <div class="slide_item" th:each = "dto:${searchHotelDetail}">
														            <!-- 스탠다드 객실 사진만 불러옴 -->
														            <img th:if= "${dto.type == 'standard'}"  th:src = "@{|/hotel/${dto.url}|}" 
														            style="max-width:100%; height:auto;"/>
														        </div>
															</div>
															<span class="nextButton">▶</span>  <!--다음 버튼 -->
															<span class="prevButton">◀</span>   <!--이전 버튼 -->
															  	<div class="Thumbnail">  <!--썸네일을 감쌀 뼈대 -->
															  		<div class="thumbnail_item"></div>   <!--썸네일 아이템들 -->
															  		
																</div>   
											           </div>
											            <!-- 자동 캐러샐 끝 -->	   
											            
											     </div>
       						<!--  ============================== 모달 end 구분선================================== -->
                                                </td>                                                
                                                <td class="persons">2<i class="fa fa-user"></i></td>
                                                <td class="price">[[${dto2[0].standard}]]</td>
                                                <td class="rooms"></td>
                                                <td>
                                                    <div class="form-group">
                                                        <button type="submit" class="btn btn-primary btn-rounded">객실 예약</button>
                                                    </div>
                                                    <!--end form-group-->
                                                </td>

                                            </tr>
                                            <!--end tr.room-->
                                        </tbody>
                                    </table>
                                    <!--end table-->
                                </form>
                               <!-- 스탠다드룸에 대한 form id = "room_1" 태그 end -->
                               
                               
                               <!-- 2. 스위트룸에 대한 form id = "room_2" 태그 start -->
                                <form id="room_2" th:action="@{/paymentPage}" method="post">
                                <!-- 0424 input 태그 추가 4줄 부분 -->
                                  <input type="hidden" name="hotel_id" th:value="${dto2[0].hotel_id}"/>
								  <input type="hidden" name="room_type" value="sweet"/>
								  <input type="hidden" name="checkin" th:value="${checkin}"/>
								  <input type="hidden" name="checkout" th:value="${checkout}"/>
                                    <table class="table">
                                        <tbody>
                                        <tr class="room">
                                            <td class="room-type">
                                                <a href=""><h3>스위트룸</h3></a>
                                                                                               
                                                <ul class="info">
                                                    <li>여기에 뭐 적나</li>
                                                    <li>여기에 뭐 적나</li>
                                                </ul>
                                            </td>
                                            <td class="persons">4<i class="fa fa-user"></i></td>
                                            <td class="price">[[${dto2[0].sweet}]]</td>
                                            <td class="rooms">
                                                <select class="framed" name="room_2_nights">
                                                    <option value="1">0</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                </select>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <button type="submit" class="btn btn-primary btn-rounded">객실 예약</button>
                                                </div>
                                                <!--end form-group-->
                                            </td>
                                        </tr>
                                        <!--end tr.room-->
                                        </tbody>
                                    </table>
                                    <!--end table-->
                                </form>
        					<!-- 스위트룸에 대한 form id = "room_2" 태그 end -->                     
		
							<!-- 3. 디럭스룸에 대한 form id = "room_3" 태그 start -->
                                <form id="room_3" th:action="@{/paymentPage}" method="post">
                                <!-- 0424 input 태그 추가 4줄 부분 -->
                                  <input type="hidden" name="hotel_id" th:value="${dto2[0].hotel_id}"/>
								  <input type="hidden" name="room_type" value="deluxe"/>
								  <input type="hidden" name="checkin" th:value="${checkin}"/>
								  <input type="hidden" name="checkout" th:value="${checkout}"/>
                                    <table class="table">
                                        <tbody>
                                        <tr class="room">
                                            <td class="room-type">
                                                <a href="" ><h3>디럭스룸</h3></a>
                                                <ul class="info">
                                                    <li>여기에 뭐 적나</li>
                                                    <li>여기에 뭐 적나</li>
                                                </ul>
                                            </td>
                                            <td class="persons">4<i class="fa fa-user"></i></td>
                                            <td class="price">[[${dto2[0].deluxe}]]</td>
                                            <td class="rooms">
                                                <select class="framed" name="room_3_nights">
                                                    <option value="1">0</option>
                                                    <option value="1">1</option>
                                                    <option value="2">2</option>
                                                    <option value="3">3</option>
                                                    <option value="4">4</option>
                                                </select>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <button type="submit" class="btn btn-primary btn-rounded">객실 예약</button>
                                                </div>
                                                <!--end form-group-->
                                            </td>
                                        </tr>
                                        <!--end tr.room-->
                                        </tbody>
                                    </table>
                                    <!--end table-->
                                </form>
                               <!-- 스위트룸에 대한 form id = "room_3" 태그 end -->
                          
                            </div>
                            <!--end form-reservations-->
                        </section>
                        <section id="additional-information">
                        
                            <h2>세부 정보</h2>
                            <dl class="info">
                                <dt>Check-in:</dt>
							<dd th:text="${dto2[0].check_in}"></dd>
								<dt>Check-out:</dt>
							<dd><strong><span th:text="${dto2[0].check_out}"></span></strong></dd>
                            </dl>
                            <!--end info-->
                        </section>
                                 <section id="map">
                                    <h2>위치</h2>
                                    <div id="map-item" class="map height-300 box"></div>
                                    <!--end map-->
                                </section>
                       
                        
             <!-- 김은영이 준 reviewList띄우기 시작 -->
							<section id="reviews">
								<div th:with="hotel_id=${hotel_id}">

									<div class="title">
										<h2 class="pull-left">리뷰</h2>
										<a href="#write-a-review"
											class="btn btn-primary btn-rounded pull-right scroll">나도
											리뷰 쓰기</a>
									</div>
									<ul>

										<h3>호텔 평균 점수</h3>
										<ul class="rating-score rating-score-without-star">
											<li class="overall"><i class="fa fa-star"></i></li>
										</ul>

										<div class="reviews">

											<div class="review">
												<li th:each="review : ${reviewList}">
													<div class="row">

														<div class="col-md-9">
															<div class="comment" style="padding: 20px;">
																<div class="comment-title">
																	<figure class="rating" th:text="${review.SCORE}">평점</figure>
																	<h4 th:text="${review.USERNAME}"></h4>
																	<i class="fa fa-clock-o"></i>
																	<span th:text="${review.CREATED}"></span>
																</div>
																<br />
																<p th:text="${review.CONTEXT}"></p>
															</div>
														</div>
													</div> <!--end row-->
											</div>
										</div>
										</li>
										<!-- review : ${reviewList}반복끝 -->
									</ul>
								</div>
								<!-- 김은영이 준 reviewList띄우기 끝 -->
								</section>
								<!--end review-->
							<section id="write-a-review">
                            <h2>나도 나도 리뷰 쓰기</h2>
                            <form  class="labels-uppercase clearfix" id="review-form" method="post">
                                <div class="alert alert-dark fade in center" role="alert">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close" data-switch="#review-write">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                    <span class="sr-only">Error:</span>
                                    <a href="#tab-sign-in" data-toggle="modal" data-tab="true" data-target="#sign-in-register-modal">Please Sign in to write a review</a>
                                </div>
                                <div class="review write switch" id="review-write">
                                    <aside type="hidden" class="name" id="useid" th:value="${session.sessionUser.id}" >
                                     [[${session.sessionUser.name}]] 
                                    </aside>
                                    <div class="comment">
                                        <div class="row">
                                        
                                            <div class="col-md-8">
                                                <div class="comment-title">
                                                 <input type="hidden" id="hotel_id" name="hotel_id" th:value="${hotel_id}"> 
														<h4> [[${dto1[0].hotel_name}]]</h4>
                                                </div>
                                                
                                                <!--end title-->
                                                <div class="form-group">
                                                    <label for="form_reply_1-message">리뷰 내용<em>*</em></label>
                                                    <textarea class="form-control" id="context11" rows="8" name="context11" placeholder="Describe your stay"></textarea>
                                                </div>
                                                <!--end form-group-->
                                                <div class="form-group pull-right">
                                                    <button type="submit" class="btn btn-primary btn-rounded" onclick="review0129();">작성완료</button>
                                                </div>
                                                <!--end form-group-->
                                            </div>
                                            <!--end col-md-8-->
                                            <div class="col-md-4">
                                                <div class="comment-title">
                                                    <h4>호텔 평점</h4>
                                                </div>
                                                <!--end title-->
                                                <dl class="visitor-rating">
                                                    <dt>점수 남기기</dt>
                                                    <dd class="star-rating active" data-name="cleanliness" id="score11" name="score11">
                                                    </dd>
                                                </dl>
                                            </div>
                                            <!--end col-md-4-->
                                  
                                        </div>
                                        <!--end row-->
                                    </div>
                                    <!--end comment-->
                                </div>
                                <!--end review-->
                            </form>
                            <!--end form-->
                        </section>
                    </div>
                    <!--end main-content-->
                </div>
                <!--end col-md-9-->
            </div>
            <!--end row-->
        </div>
        <!--end container-->
   	 </div>
   	 <!--end page-content-->
	</div>
	<!-- page-wrapper end -->


<!-- ==========================================개별 스크립트 부분..============================================= -->


<script type="text/javascript">
function review0129() {
    var hotel_id = $("#hotel_id").val();
    var inputElement = document.querySelector('#score_cleanliness');
    var context = $("#context11").val();

    $.ajax({
        type: "POST",
        url: "/reviews",
        data: {hotel_id: hotel_id, score: inputElement.value, context: context},
        success: function(response) {
            // 리뷰 작성 성공 시, 업데이트된 리뷰 목록을 받아와서 기존 목록에 추가
            $.ajax({
                type: "GET",
                url: "/reviews/" + hotel_id,
                success: function(data) {
                    // 리뷰 목록이 감싸는 div 태그에 id를 추가
                    var reviewList = $("#review-list");
                    // 기존 목록에 새로운 리뷰 목록을 추가
                    reviewList.append(data);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.log(textStatus, errorThrown);
                }
            });
            alert("리뷰가 작성되었습니다.");
            $('#context11').val('');
            $('#score_cleanliness').val('');
        },
        error: function(jqXHR, textStatus, errorThrown) {
            console.log(textStatus, errorThrown);
        }
    });
    event.preventDefault();
}

</script>
 
</html>